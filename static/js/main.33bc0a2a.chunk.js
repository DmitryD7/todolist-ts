(this["webpackJsonpit-incubator-todolist-ts"]=this["webpackJsonpit-incubator-todolist-ts"]||[]).push([[0],{101:function(t,e,a){t.exports=a(132)},106:function(t,e,a){},127:function(t,e,a){},132:function(t,e,a){"use strict";a.r(e);var n=a(0),i=a.n(n),o=a(8),r=a.n(o);a(106),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var l,c,s=a(29),d=a(82),u=a.n(d).a.create({baseURL:"https://social-network.samuraijs.com/api/1.1/",withCredentials:!0,headers:{"API-KEY":"e25ce395-7836-43e0-9416-1f8978f20c93"}}),m=function(){return u.get("todo-lists")},f=function(t){return u.post("todo-lists/",{title:t})},p=function(t){return u.delete("todo-lists/".concat(t))},b=function(t,e){return u.put("todo-lists/".concat(t),{title:e})},g=function(t){return u.get("todo-lists/".concat(t,"/tasks"))},E=function(t,e){return u.post("todo-lists/".concat(t,"/tasks"),{title:e})},v=function(t,e){return u.delete("todo-lists/".concat(t,"/tasks/").concat(e))},h=function(t,e,a){return u.put("todo-lists/".concat(t,"/tasks/").concat(e),a)},k=function(){return u.get("auth/me")},C=function(){return u.delete("auth/login")},y=function(t){return u.post("auth/login",t)};!function(t){t[t.New=0]="New",t[t.InProgress=1]="InProgress",t[t.Completed=2]="Completed",t[t.Draft=3]="Draft"}(l||(l={})),function(t){t[t.Low=0]="Low",t[t.Middle=1]="Middle",t[t.High=2]="High",t[t.Urgently=3]="Urgently",t[t.Later=4]="Later"}(c||(c={}));var j=a(25),O=Object(j.b)({name:"auth",initialState:{isLoggedIn:!1},reducers:{setIsLoggedInAC:function(t,e){t.isLoggedIn=e.payload.value}}}),I=O.reducer,T=O.actions.setIsLoggedInAC,A=Object(j.b)({name:"app",initialState:{status:"idle",error:null,isInitialized:!1},reducers:{setAppStatusAC:function(t,e){t.status=e.payload.status},setAppErrorAC:function(t,e){t.error=e.payload.error},setIsInitializedAC:function(t,e){t.isInitialized=e.payload.isInitialized}}}),w=A.actions,S=w.setAppErrorAC,x=w.setAppStatusAC,L=w.setIsInitializedAC,N=A.reducer,P=function(t,e){t.messages.length?e(S({error:t.messages[0]})):e(S({error:"Some error occurred"})),e(x({status:"failed"}))},F=function(t,e){e(S({error:t.message?t.message:"Some error occurred"})),e(x({status:"failed"}))},z=Object(j.b)({name:"todoLists",initialState:[],reducers:{setTodolistsAC:function(t,e){return e.payload.todolists.map((function(t){return Object(s.a)(Object(s.a)({},t),{},{filter:"all",entityStatus:"idle"})}))},removeTodolistAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.id}));a>-1&&t.splice(a,1)},addTodolistAC:function(t,e){t.unshift(Object(s.a)(Object(s.a)({},e.payload.todolist),{},{filter:"all",entityStatus:"idle"}))},changeTodolistTitleAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.id}));a>-1&&(t[a].title=e.payload.title)},changeTodolistFilterAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.id}));a>-1&&(t[a].filter=e.payload.filter)},changeTodolistEntityStatusAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.id}));a>-1&&(t[a].entityStatus=e.payload.status)}}}),D=z.actions,R=D.changeTodolistEntityStatusAC,B=D.changeTodolistFilterAC,M=D.changeTodolistTitleAC,q=D.addTodolistAC,H=D.removeTodolistAC,U=D.setTodolistsAC,Z=z.reducer,J=Object(j.b)({name:"tasks",initialState:{},reducers:{removeTaskAC:function(t,e){var a=t[e.payload.todolistId],n=a.findIndex((function(t){return t.id===e.payload.taskId}));n>-1&&a.splice(n,1)},addTaskAC:function(t,e){t[e.payload.task.todoListId].unshift(e.payload.task)},updateTaskAC:function(t,e){var a=t[e.payload.todolistId],n=a.findIndex((function(t){return t.id===e.payload.taskId}));n>-1&&(a[n]=Object(s.a)(Object(s.a)({},a[n]),e.payload.model))},setTasksAC:function(t,e){t[e.payload.todolistId]=e.payload.tasks}},extraReducers:function(t){t.addCase(q,(function(t,e){t[e.payload.todolist.id]=[]})),t.addCase(H,(function(t,e){delete t[e.payload.id]})),t.addCase(U,(function(t,e){e.payload.todolists.forEach((function(e){return t[e.id]=[]}))}))}}),K=J.actions,W=K.removeTaskAC,$=K.addTaskAC,_=K.updateTaskAC,V=K.setTasksAC,Y=J.reducer,G=function(t,e,a){return function(n,i){var o=i().tasks[e].find((function(e){return e.id===t}));if(o){var r=Object(s.a)({title:o.title,startDate:o.startDate,priority:o.priority,description:o.description,deadline:o.deadline,status:o.status},a);h(e,t,r).then((function(a){0===a.data.resultCode?n(_({taskId:t,model:r,todolistId:e})):P(a.data,n)})).catch((function(t){return F(t,n)}))}}},Q=a(21),X=a(50),tt=Object(Q.c)({tasks:Y,todolists:Z,app:N,auth:I}),et=Object(j.a)({reducer:tt,middleware:function(t){return t().prepend(X.a)}});window.store=et;var at=a(15),nt=a(34),it=(a(127),a(176)),ot=a(177),rt=a(178),lt=a(168),ct=a(134),st=a(172),dt=a(179),ut=a(180),mt=a(89),ft=a.n(mt),pt=a(173),bt=a(133),gt=a(47),Et=a(181),vt=a(169),ht=i.a.memo((function(t){var e=t.addItem,a=t.disabled,o=void 0!==a&&a,r=Object(n.useState)(""),l=Object(gt.a)(r,2),c=l[0],s=l[1],d=Object(n.useState)(null),u=Object(gt.a)(d,2),m=u[0],f=u[1],p=function(){""!==c.trim()?e(c):f("Field is required!"),s("")};return i.a.createElement("div",{onBlur:function(){return f(null)}},i.a.createElement(Et.a,{disabled:o,variant:"outlined",value:c,onChange:function(t){s(t.currentTarget.value)},onKeyPress:function(t){null!==m&&f(null),13===t.charCode&&p()},error:!!m,label:"Title",helperText:m}),i.a.createElement(lt.a,{disabled:o,onClick:p,color:"primary"},i.a.createElement(vt.a,null)))})),kt=i.a.memo((function(t){var e=t.disabled,a=void 0!==e&&e,o=Object(nt.a)(t,["disabled"]),r=Object(n.useState)(!1),l=Object(gt.a)(r,2),c=l[0],s=l[1],d=Object(n.useState)(o.title),u=Object(gt.a)(d,2),m=u[0],f=u[1];return c?i.a.createElement(Et.a,{variant:"standard",value:m,onBlur:function(){m.trim()?o.setNewTitle(m):f(o.title),s(!1)},autoFocus:!0,onChange:function(t){f(t.currentTarget.value)}}):i.a.createElement("span",{onDoubleClick:function(){!a&&s(!0)}},o.title)})),Ct=a(171),yt=a(183),jt=a(170),Ot=i.a.memo((function(t){return i.a.createElement("div",{key:t.task.id,className:t.task.status===l.Completed?"is-done":"",style:{display:"flex",alignItems:"center",justifyContent:"end"}},i.a.createElement(yt.a,{color:"secondary",checked:t.task.status===l.Completed,onChange:function(e){t.changeTaskStatus(t.task.id,e.currentTarget.checked?l.Completed:l.New,t.todoListId)}}),i.a.createElement(kt,{title:t.task.title,setNewTitle:function(e){t.changeTaskTitle(t.task.id,e,t.todoListId)}}),i.a.createElement(lt.a,{onClick:function(){t.removeTask(t.task.id,t.todoListId)},style:{marginLeft:"auto"}},i.a.createElement(jt.a,null)))})),It=i.a.memo((function(t){var e=t.demo,a=void 0!==e&&e,o=Object(nt.a)(t,["demo"]);Object(n.useEffect)((function(){var t;a||c((t=o.todolist.id,function(e){e(x({status:"loading"})),g(t).then((function(a){e(V({todolistId:t,tasks:a.data.items})),e(x({status:"succeeded"}))})).catch((function(t){return F(t,e)}))}))}),[]);var r=Object(at.c)((function(t){return t.tasks[o.todolist.id]})),c=Object(at.b)(),s=Object(n.useCallback)((function(t){return c(function(t,e){return function(a){a(x({status:"loading"})),E(t,e).then((function(t){0===t.data.resultCode?(a($({task:t.data.data.item})),a(x({status:"succeeded"}))):P(t.data,a)})).catch((function(t){return F(t,a)}))}}(o.todolist.id,t))}),[]),d=Object(n.useCallback)((function(t,e,a){c(G(t,a,{status:e}))}),[c]),u=Object(n.useCallback)((function(t,e,a){c(G(t,a,{title:e}))}),[c]),m=Object(n.useCallback)((function(t,e){var a,n;c((a=t,n=e,function(t){t(x({status:"loading"})),v(n,a).then((function(){t(W({taskId:a,todolistId:n})),t(x({status:"succeeded"}))})).catch((function(e){return F(e,t)}))}))}),[c]),f=r;"active"===o.todolist.filter&&(f=r.filter((function(t){return t.status===l.New}))),"completed"===o.todolist.filter&&(f=r.filter((function(t){return t.status===l.Completed})));var h=f.map((function(t){return i.a.createElement(Ot,{key:t.id,task:t,todoListId:o.todolist.id,changeTaskStatus:d,changeTaskTitle:u,removeTask:m})})),k=Object(n.useCallback)((function(t){return c((e=o.todolist.id,a=t,function(t){return b(e,a).then((function(n){0===n.data.resultCode?t(M({id:e,title:a})):P(n.data,t)})).catch((function(e){return F(e,t)}))}));var e,a}),[c,o.todolist.id]),C=Object(n.useCallback)((function(){return c(B({id:o.todolist.id,filter:"all"}))}),[c,o.todolist.id]),y=Object(n.useCallback)((function(){return c(B({id:o.todolist.id,filter:"active"}))}),[c,o.todolist.id]),j=Object(n.useCallback)((function(){return c(B({id:o.todolist.id,filter:"completed"}))}),[c,o.todolist.id]),O=Object(n.useCallback)((function(){return c((t=o.todolist.id,function(e){e(x({status:"loading"})),e(R({id:t,status:"loading"})),p(t).then((function(){e(H({id:t})),e(x({status:"succeeded"}))})).catch((function(t){return F(t,e)}))}));var t}),[c,o.todolist.id]);return i.a.createElement("div",null,i.a.createElement("h3",null,i.a.createElement(kt,{title:o.todolist.title,setNewTitle:k,disabled:"loading"===o.todolist.entityStatus}),i.a.createElement(lt.a,{onClick:O,disabled:"loading"===o.todolist.entityStatus},i.a.createElement(Ct.a,null))),i.a.createElement(ht,{addItem:s,disabled:"loading"===o.todolist.entityStatus}),i.a.createElement("div",{style:{margin:"20px 0"}},h),i.a.createElement("div",null,i.a.createElement(st.a,{variant:"all"===o.todolist.filter?"outlined":"text",onClick:C},"All"),i.a.createElement(st.a,{variant:"active"===o.todolist.filter?"outlined":"text",onClick:y,color:"primary"},"Active "),i.a.createElement(st.a,{variant:"completed"===o.todolist.filter?"outlined":"text",onClick:j,color:"secondary"},"Completed")))})),Tt=a(12);function At(t){var e=t.demo,a=void 0!==e&&e;Object(nt.a)(t,["demo"]);Object(n.useEffect)((function(){a&&!r||l((function(t){t(x({status:"loading"})),m().then((function(e){t(U({todolists:e.data})),t(x({status:"idle"}))})).catch((function(e){return F(e,t)}))}))}),[]);var o=Object(at.c)((function(t){return t.todolists})),r=Object(at.c)((function(t){return t.auth.isLoggedIn})),l=Object(at.b)(),c=Object(n.useCallback)((function(t){l(function(t){return function(e){e(x({status:"loading"})),f(t).then((function(t){0===t.data.resultCode?(e(q({todolist:t.data.data.item})),e(x({status:"succeeded"}))):P(t.data,e)})).catch((function(t){return F(t,e)}))}}(t))}),[l]);return r?i.a.createElement(i.a.Fragment,null,i.a.createElement(pt.a,{container:!0,style:{padding:"20px",margin:"10px"}},i.a.createElement(ht,{addItem:c})),i.a.createElement(pt.a,{container:!0,spacing:10},o.map((function(t){return i.a.createElement(pt.a,{item:!0,key:t.id},i.a.createElement(bt.a,{style:{padding:"10px"}},i.a.createElement(It,{todolist:t,demo:a,key:t.id})))})))):i.a.createElement(Tt.a,{to:"/login"})}var wt=a(185),St=a(182);function xt(t){return i.a.createElement(St.a,Object.assign({elevation:6,variant:"filled"},t))}function Lt(){var t=Object(at.c)((function(t){return t.app.error})),e=Object(at.b)(),a=function(t,a){"clickaway"!==a&&e(S({error:null}))},n=null!==t;return i.a.createElement(wt.a,{open:n,autoHideDuration:6e3,onClose:a},i.a.createElement(xt,{onClose:a,severity:"error"},t))}var Nt=a(186),Pt=a(167),Ft=a(174),zt=a(175),Dt=a(90),Rt=function(){var t=Object(at.c)((function(t){return t.auth.isLoggedIn})),e=Object(at.b)(),a=Object(Dt.a)({initialValues:{email:"",password:"",rememberMe:!1},validate:function(t){var e={};return t.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(t.email)||(e.email="Invalid email address"):e.email="Required",t.password?t.password.length<3&&(e.password="Too short password"):e.password="Required",e},onSubmit:function(t){var a;e((a=t,function(t){t(x({status:"loading"})),y(a).then((function(e){0===e.data.resultCode?(t(T({value:!0})),t(x({status:"succeeded"}))):P(e.data,t)})).catch((function(e){F(e,t)}))}))}});return t?i.a.createElement(Tt.a,{to:"/"}):i.a.createElement(pt.a,{container:!0,justify:"center"},i.a.createElement(pt.a,{item:!0,xs:4},i.a.createElement("form",{onSubmit:a.handleSubmit},i.a.createElement(Nt.a,null,i.a.createElement(Pt.a,null,i.a.createElement("p",null,"To log in get registered",i.a.createElement("a",{href:"https://social-network.samuraijs.com/",target:"_blank"},"here")),i.a.createElement("p",null,"or use common test account credentials:"),i.a.createElement("p",null,"Email: free@samuraijs.com"),i.a.createElement("p",null,"Password: free")),i.a.createElement(Ft.a,null,i.a.createElement(Et.a,Object.assign({label:"Email",margin:"normal",type:"email"},a.getFieldProps("email"))),a.errors.email?i.a.createElement("div",{style:{color:"red"}},a.errors.email):null,i.a.createElement(Et.a,Object.assign({type:"password",label:"Password",margin:"normal"},a.getFieldProps("password"))),a.errors.password?i.a.createElement("div",{style:{color:"red"}},a.errors.password):null,i.a.createElement(zt.a,Object.assign({label:"Remember me",control:i.a.createElement(yt.a,null)},a.getFieldProps("rememberMe"))),i.a.createElement(st.a,{type:"submit",variant:"contained",color:"primary"},"Login"))))))},Bt=i.a.memo((function(t){var e=t.demo,a=void 0!==e&&e,o=(Object(nt.a)(t,["demo"]),Object(at.c)((function(t){return t.app.status}))),r=Object(at.c)((function(t){return t.app.isInitialized})),l=Object(at.c)((function(t){return t.auth.isLoggedIn}));Object(n.useEffect)((function(){c((function(t){k().then((function(e){0===e.data.resultCode?t(T({value:!0})):t(T({value:!1})),t(L({isInitialized:!0}))}))}))}),[]);var c=Object(at.b)(),s=Object(n.useCallback)((function(){c((function(t){t(x({status:"loading"})),C().then((function(e){0===e.data.resultCode?(t(T({value:!1})),t(x({status:"succeeded"}))):P(e.data,t)})).catch((function(e){F(e,t)}))}))}),[]);return r?i.a.createElement("div",{className:"App"},i.a.createElement(ot.a,{position:"static"},i.a.createElement(Lt,null),i.a.createElement(rt.a,null,i.a.createElement(lt.a,{edge:"start",color:"inherit","aria-label":"menu"},i.a.createElement(ft.a,null)),i.a.createElement(ct.a,{variant:"h6"},"ToDo-Lists"),l&&i.a.createElement(st.a,{color:"inherit",onClick:s},"Log out")),"loading"===o&&i.a.createElement(dt.a,null)),i.a.createElement(ut.a,{fixed:!0},i.a.createElement(Tt.b,{exact:!0,path:"/",render:function(){return i.a.createElement(At,{demo:a})}}),i.a.createElement(Tt.b,{path:"/login",render:function(){return i.a.createElement(Rt,null)}}))):i.a.createElement("div",{style:{position:"fixed",top:"30%",textAlign:"center",width:"100%"}},i.a.createElement(it.a,null))})),Mt=a(49);r.a.render(i.a.createElement(at.a,{store:et},i.a.createElement(Mt.a,null,i.a.createElement(Bt,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[101,1,2]]]);
//# sourceMappingURL=main.33bc0a2a.chunk.js.map